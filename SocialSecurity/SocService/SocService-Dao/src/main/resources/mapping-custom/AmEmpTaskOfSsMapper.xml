<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ciicsh.gto.afsupportcenter.socialsecurity.socservice.dao.AmEmpTaskOfSsMapper">

    <resultMap id="selfResultMap" extends="BaseResultMap" type="com.ciicsh.gto.afsupportcenter.socialsecurity.socservice.dto.AmEmpTaskDTO">
        <result column="open_af_date" property="openAfDate" />
        <result column="archive_place" property="archivePlace" />
        <result column="employ_feedback_opt_date" property="employFeedbackOptDate" />
    </resultMap>
<select id="queryReworkInfo" resultMap="selfResultMap">
    select
    et.task_status,
    em.open_af_date,
    ar.archive_place,
    ar.employ_feedback_opt_date
    FROM am_emp_task et
    INNER JOIN am_employment em ON em.emp_task_id=et.emp_task_id AND em.is_active=1
    INNER JOIN am_archive ar ON ar.employment_id=em.employment_id
    WHERE et.is_active=1
    AND et.employee_id =#{employeeId}
    AND et.company_id =#{companyId}
    ORDER BY em.created_time DESC
    LIMIT 1
</select>
</mapper>
