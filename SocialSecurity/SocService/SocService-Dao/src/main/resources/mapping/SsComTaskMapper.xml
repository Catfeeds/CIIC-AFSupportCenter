<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ciicsh.gto.afsupportcenter.socialsecurity.socservice.dao.SsComTaskMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="com.ciicsh.gto.afsupportcenter.socialsecurity.socservice.entity.SsComTask">
        <id column="com_task_id" property="comTaskId" />
        <result column="customer_id" property="customerId" />
        <result column="com_account_id" property="comAccountId" />
        <result column="company_id" property="companyId" />
        <result column="task_category" property="taskCategory" />
        <result column="expire_date" property="expireDate" />
        <result column="submitter_id" property="submitterId" />
        <result column="submitter_name" property="submitterName" />
        <result column="submitter_dept_id" property="submitterDeptId" />
        <result column="submitter_dept_name" property="submitterDeptName" />
        <result column="submit_time" property="submitTime" />
        <result column="submit_remark" property="submitRemark" />
        <result column="task_form_content" property="taskFormContent" />
        <result column="chat_history" property="chatHistory" />
        <result column="dynamic_extend" property="dynamicExtend" />
        <result column="task_status" property="taskStatus" />
        <result column="handle_user_id" property="handleUserId" />
        <result column="handle_user_name" property="handleUserName" />
        <result column="start_handle_date" property="startHandleDate" />
        <result column="send_check_date" property="sendCheckDate" />
        <result column="finish_date" property="finishDate" />
        <result column="handle_remark" property="handleRemark" />
        <result column="rejection_remark" property="rejectionRemark" />
        <result column="business_interface_id" property="businessInterfaceId" />
        <result column="task_id" property="taskId" />
        <result column="ss_account" property="ssAccount" />
        <result column="bank_account" property="bankAccount" />
        <result column="com_account_name" property="comAccountName" />
        <result column="payment_bank" property="paymentBank" />
        <result column="payment_way" property="paymentWay" />
        <result column="bill_receiver" property="billReceiver" />
        <result column="industry_category" property="industryCategory" />
        <result column="start_month" property="startMonth" />
        <result column="expire_date_front" property="expireDateFront" />
        <result column="settlement_area" property="settlementArea" />
        <result column="legal_person" property="legalPerson" />
        <result column="contact_address" property="contactAddress" />
        <result column="dispatch_material" property="dispatchMaterial" />
        <result column="is_active" property="isActive" />
        <result column="created_time" property="createdTime" />
        <result column="modified_time" property="modifiedTime" />
        <result column="created_by" property="createdBy" />
        <result column="modified_by" property="modifiedBy" />
	</resultMap>
    
    <resultMap id="ComTaskExtMap" type="com.ciicsh.gto.afsupportcenter.socialsecurity.socservice.bo.customer.ComAccountExtBO">
        <result column="customer_id" property="customerId" />
        <result column="com_account_id" property="comAccountId" />
        <result column="com_account_name" property="comAccountName" />
        <result column="company_id" property="companyId" />
        <result column="company_name" property="companyName" />
        <result column="ss_account" property="ssAccount" />
        <result column="bank_account" property="bankAccount" />
        <result column="settlement_area" property="settlementArea" />
        <result column="payment_bank" property="paymentBank" />
        <result column="payment_way" property="paymentWay" />
        <result column="bill_receiver" property="billReceiver" />
        <result column="expire_date" property="expireDate" />
        <result column="legal_person" property="legalPerson" />
        <result column="contact_address" property="contactAddress" />
        <result column="query_account" property="queryAccount" />
        <result column="industry_category" property="industryCategory" />
        <result column="com_ratio" property="comRatio" />
        <result column="dispatch_material" property="dispatchMaterial" />
        <result column="remark" property="remark" />
    </resultMap>

    <select id="getComTaskByCompanyId" resultMap="ComTaskExtMap">
        SELECT
          <include refid="ComTask_Ext_Columns"/>
        FROM
          ss_com_task a
        INNER JOIN sal_company b ON a.company_id = b.company_id
        WHERE
          a.is_active = 1
        AND b.is_active = 1
        AND a.task_category IN (1,2)
        AND a.company_id = #{companyId}
    </select>

    <sql id="ComTask_Ext_Columns">
        a.customer_id,
        a.com_account_id,
        a.com_account_name,
        a.company_id,
        b.title AS 'company_ame',
        a.ss_account,
        a.bank_account,
        a.settlement_area,
        a.payment_bank,
        a.payment_way,
        a.bill_receiver,
        a.expire_date_front AS 'expire_date',
        a.legal_person,
        a.contact_address,
        '' AS 'query_account',
        a.industry_category,
        '' AS 'com_ratio',
        a.dispatch_material,
        a.submit_remark AS 'remark',
        a.task_status
    </sql>

</mapper>
